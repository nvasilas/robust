\chapter{Εύρωστη τοποθέτηση πόλων}\label{ch:pp}
Στο παρόν κεφάλαιο θα εξετάσουμε το πρόβλημα της εύρωστης τοποθέτησης πόλων. Η
τοποθέτηση πόλων είναι μία τεχνική ελέγχου κατά την οποία επιδιώκουμε να
ικανοποιήσουμε συγκεκριμένα επιθυμητά χαρακτηριστικά, όπως χρόνος ανύψωσης,
χρόνος αποκατάστασης, ευστάθεια κτλ. Στην περίπτωση αβέβαιων συστημάτων, η
ανάγκη ικανοποίησης των επιθυμητών χαρακτηριστικών είναι επιπλέον επιτακτική,
καθώς κάποια διαταραχή μπορεί να οδηγήσει σε έντονη απόκλιση από την επιθυμητή
κατάσταση. Η ανάπτυξη του κεφαλαίου βασίζεται στο βιβλίο~\cite{kosmidou2009robust}.


Θα μελετήσουμε το τυπικό γραμμικό αβέβαιο σύστημα της μορφής
\begin{equation}\label{eq:pp_un_ss}
    \dot{x}(t) = (A + \Delta A)x(t) + Bu(t), \quad x(t_0) = x_0,
\end{equation}
για \( t \geq t_0 \), όπου \( x(t) \in \mathbb{R}^n \) το διάνυσμα κατάστασης,
\( u(t) \in \mathbb{R}^m \) το διάνυσμα ελέγχου, \( A \) και \( B \) οι πίνακες
κατάστασης και ελέγχου αντίστοιχα, κατάλληλων διαστάσεων. Η αβεβαιότητα
περιγράφεται από τη μορφή
\[
    \Delta A = \sum_{i = 1}^{k} A_i r_i
\]
όπου \( A_i \) είναι σταθερός πίνακας και \( r_i \) βαθμωτό
μέγεθος, που μπορεί να είναι και χρονικά μεταβαλλόμενα στη γενική περίπτωση. Με
την παραπάνω περιγραφή, η παράμετρος \( r_i \) ανήκει στο σύνολο
\[
    \mathcal{R} := \{ r \in \mathbb{R}^k: |r_i| \leq \bar{r}, \bar{r} > 0, ,i = 1, \dots,
    k \}.
\]
Χωρίς να μειωθεί η γενικότητα τα όρια μπορούν να κανονικοποιηθούν, δηλαδή \(
\bar{r} =  1 \). Έτσι ονομάζουμε \emph{αποδεκτή αβεβαιότητα}, τις
αβεβαιότητες που ικανοποιούν τις γραμμικές μορφές, όπως ορίστηκαν παραπάνω, και
βρίσκονται εντός των φραγμένων συνόλων.

Όπως είδαμε στο κεφάλαιο του εγγυημένου κόστους, ο πίνακας που περιγράφει τις
αβεβαιότητες επιτρέπει, το μη μοναδικό, διαχωρισμό μοναδιαίας τάξης
\[
    A_i = d_ie_i^T,
\]
όπου \( i = 1, \dots k \) και \( d_i, e_i \in \mathbb{R}^n \). Με βάση τον
παραπάνω διαχωρισμό ορίζονται οι συμμετρικοί και θετικά ορισμένοι
πίνακες
\[
   T = \sum_{i = 1}^k d_id_i^T, \quad
   U = \sum_{i = 1}^k e_ie_i^T.
\]
Θα θεωρήσουμε τις επιδόσεις του συστήματος ότι περιγράφονται από τετραγωνική
συνάρτηση κόστους
\begin{equation}\label{eq:pp_un_cost}
    J(x_0, \Delta A, t) = \int_{t_0}^{\infty}
    \left[ x^T(t)Qx(t) + u^T(t)Ru(t) \right] \, dt.
\end{equation}
Σε πλήρη αντιστοιχία με το κεφάλαιο του εγγυημένου κόστους, για το σύστημα~\eqref{eq:pp_un_ss}
με την τετραγωνική συνάρτηση κόστους~\eqref{eq:pp_un_cost} η συνάρτηση
\( \tilde{u}:\mathbb{R} \to \mathbb{R}^m \) ονομάζεται \emph{νόμος ελέγχου εγγυημένου κόστους},
αν υπάρχει ένας θετικός αριθμός \( \tilde{J} \), που λέγεται \emph{εγγυημένο κόστος}, τέτοιος ώστε
\[
    J(x_0, \tilde{u}, \Delta A, t) \leq \tilde{J}
\]
για όλες τις αποδεκτές αβεβαιότητες. Αποδεικνύεται ότι ο γραμμικός νόμος ελέγχου
ανάδρασης κατάστασης
\[
    \tilde{u}(t) = Kx(t) = - R^{-1}B^{T}Px(t),
\]
είναι ένας νόμος ελέγχου εγγυημένου κόστους και
\[
    \tilde{J}(x_0) = x_0^{T}Px_0,
\]
είναι ένα εγγυημένο κόστος ή με κάποιες τεχνικές παραδοχές στην αντίστοιχη μορφή
\begin{equation}\label{eq:pp_un_gcc_J}
    \tilde{J} = \tr{P},
\end{equation}
αν υπάρχει ένας θετικά ορισμένος συμμετρικός πίνακας
\( P \) που ικανοποιεί τη γενικευμένη αλγεβρική εξίσωση \tl{Riccati}, για
συντομία \tl{GARE},
\begin{equation}\label{eq:pp_un_gare_general}
    PA + A^{T}P - P(BR^{-1}B^{T} - T)P + Q + U = 0.
\end{equation}
Ακόμα το σύστημα που προκύπτει είναι ασυμπτωτικά ευσταθές για κάθε αποδεκτή
αβεβαιότητα, δηλαδή για κάθε \( r_i \in \mathcal{R} \).

Όπως αναφέραμε, επιθυμούμε το σύστημα να τείνει εκθετικά στο μηδέν αλλά
επιθυμούμε να έχει το σύστημα κάποια συγκεκριμένα χαρακτηριστικά. Αυτό
μεταφράζεται, οι ιδιοτιμές του κλειστού συστήματος θέλουμε να βρίσκονται
αριστερά από κάποια επιλεγμένη τιμή, έστω \( a \), ή αντίστοιχα το κλειστό
σύστημα να έχει \emph{βαθμό σχετικής ευστάθειας} \( a \).

Για να επιτύχουμε τον προαναφερθέν βαθμό σχετικής ευστάθειας, θεωρούμε τους
μετασχηματισμούς στο πεδίο του χρόνου, \( \hat{x}(t) := e^{at}x(t) \)
και \( \hat{u}(t) := e^{at}u(t) \) και έτσι το σύστημα μετασχηματίζεται
\begin{equation}\label{eq:pp_un_a}
    \dot{\hat{x}}(t) = (A + \Delta A + aI)\hat{x}(t) + B\hat{u}(t), \quad
    \hat{x}(t_0) = \hat{x}_0 = e^{at_0}x_0,
\end{equation}
με αντικειμενική συνάρτηση όπως της σχέσης~\eqref{eq:pp_un_cost} αλλά για τις
νέες συντεταγμένες \( \hat{x} \) και \( \hat{u} \).

Με την περιγραφή αυτή το πρόβλημα μετατρέπεται σε ένα πρόβλημα εγγυημένου
κόστους που μπορεί να λυθεί με τις μεθόδους που αναφέραμε μέχρι τώρα.

Κατά το σχεδιασμό συστημάτων χωρίς αβεβαιότητες, η επιλογή των μητρώων
στάθμισης επιτρέπει τη βελτίωση των χαρακτηριστικών κλειστού βρόχου, όπως
περιθώρια ευρωστίας. Αντίστοιχα, για την περίπτωση αβέβαιων συστημάτων η
κατάλληλη επιλογή του μητρώου στάθμισης μπορεί να μας οδηγήσει στο βαθμό
σχετικής ευστάθειας που επιθυμούμε.

Έστω ότι ο συμμετρικός και θετικά ορισμένος πίνακας \( T \) μπορεί να γραφτεί
στη μορφή \( T = B\hat{T}B^T \), που ισχύει όταν οι αβεβαιότητες ικανοποιούν
τις συνθήκες προσαρμογής. Τότε η αλγεβρική εξίσωση \tl{Riccati} για το μη
αβέβαιο σύστημα γίνεται
\begin{equation}\label{eq:pp_un_wei}
    PA + A^{T}P - PB\hat{R}^{-1}B^{T} - TP + \hat{Q} = 0,
\end{equation}
όπου \( \hat{R}^{-1} = R^{-1} - \hat{T} \) και \( \hat{Q} = Q + U \). Ο νόμος
ελέγχου είναι
\[
    u(t) = -\hat{R}^{-1}B^TPx(t)
\]
και το κλειστό σύστημα γίνεται
\begin{equation}\label{eq:pp_closed}
    \dot{x}(t) = (A - B\hat{R}^{-1}B^TP)x(t) = Fx(t).
\end{equation}
Αντίστοιχα, το κλειστό αβέβαιο σύστημα περιγράφεται από
\[
    \dot{x}(t) = Fx(t).
\]
Η αλγεβρική γενικευμένη εξίσωση \tl{Riccati} της σχέσης~\eqref{eq:pp_un_gare_general}
συνδέεται με τη φασματική δομή του Χαμιλτονιανού πίνακα
\begin{equation*}
    H =
    \begin{pmatrix}
        A & -BR^{-1}B^T + T \\
        -Q - U & -A^T
    \end{pmatrix}.
\end{equation*}
Αν πάρουμε τη μορφή \tl{Jordan} του \( H \) προκύπτει
\begin{equation}\label{eq:pp_hamil}
    \begin{pmatrix}
        A & -BR^{-1}B^T + T \\
        -Q - U & -A^T
    \end{pmatrix}
    \begin{pmatrix}
        X_0 & W_0 \\
        Y_0 & Z_0
    \end{pmatrix} =
    \begin{pmatrix}
        X_0 & W_0 \\
        Y_0 & Z_0
    \end{pmatrix}
    \begin{pmatrix}
        \Lambda_s & 0 \\
        0 & \Lambda_u
    \end{pmatrix},
\end{equation}
όπου \( \Lambda_s \) και \( \Lambda_u \) είναι διαγώνιοι πίνακες των ευσταθών
και ασταθών ιδιοτιμών του \( H \) αντίστοιχα, όταν ο \( H \) έχει διακριτές
ιδιοτιμές, και οι πίνακες \( X_0, W_0, Y_0, Z_0 \) είναι τα γενικευμένα
ιδιοδιανύσματα του \( H \). Αποδεικνύεται ότι αν το ζεύγος \( (A, B) \) είναι
σταθεροποιήσιμο, τότε \( P = Y_0 X_0^{-1} \) και \( FX_0 = X_0\Lambda_s \).
Ακόμα, αν το ζεύγος \( (A, B) \) είναι πλήρως ελέγξιμο, τότε ο συμμετρικός και
αρνητικά ορισμένος πίνακας \( P_u = Z_0 W_0^{-1} \) υπάρχει και είναι λύση
της~\eqref{eq:pp_un_gare_general}. Επίσης, αποδεικνύεται ότι αντικαθιστώντας
τον πίνακα στάθμισης των καταστάσεων \( Q \) με \( Q + \Delta Q \), όπου \(
\Delta Q = - 2aP_u \), στη συνάρτηση κόστους, οι ιδιοτιμές του κλειστού
ονομαστικού συστήματος μετατοπίζονται κατά \( -2a \). Η αντίστοιχη γενικευμένη
εξίσωση \tl{Riccati} γίνεται
\begin{equation}\label{eq:pp_un_gare_a}
    \bar{P}(A + aI) + (A + aI)^{T}\bar{P} - \bar{P}(BR^{-1}B^{T} - T)\bar{P} +
    Q + U - 2aP_u= 0.
\end{equation}

Σύμφωνα με τα παραπάνω προκύπτει το παρακάτω θεώρημα.
\begin{theorem}[Θεώρημα 5.7 της Κοσμίδου~\cite{kosmidou2009robust}]
    Έστω \( \Lambda_s \) το φάσμα του κλειστού συστήματος~\eqref{eq:pp_closed}
    για κάποιους δεδομένους πίνακες βάρους \( Q \) και \( R \). Ακόμη, έστω οι
    εισάγεται βαθμός σχετικής ευστάθειας \( a \) και ο πίνακας βάρους
    κατάστασης \( Q \) τροποποιείται κατά
    \[
        \Delta Q = -2aP_u,
    \]
    όπου \( P_u \) είναι η αρνητικά ορισμένη λύση
    της~\eqref{eq:pp_un_gare_general}. Τότε το φάσμα \( \Lambda(\tilde{F}_s) \)
    του ονομαστικού κλειστού συστήματος με βαθμό σχετικής ευστάθειας \( a \)
    και τροποποιημένο δείκτη επιδόσεων είναι
    \[
        \Lambda(\tilde{F}_s) = \Lambda_s - 2aI.
    \]
\end{theorem}
Σύμφωνα με το παραπάνω θεώρημα εφαρμόζοντας τον νόμο ελέγχου
\[
    u(t) = -\hat{R}^{-1}B^T\bar{P}_sx(t),
\]
όπου \( \bar{P}_s \) είναι η θετικά ορισμένη λύση της
σχέσης~\eqref{eq:pp_un_gare_a}, οι ιδιοτιμές του ονομαστικού κλειστού
συστήματος μετατοπίζονται κατά \( -2a \) και αντίστοιχα οι ιδιοτιμές του
αβέβαιου συστήματος~\eqref{eq:pp_un_ss} βρίσκονται αριστερά του \( -a \) του
μιγαδικού επιπέδου, για όλες τις αποδεκτές αβεβαιότητες.

Ο παραπάνω νόμος ελέγχου προϋποθέτει την ύπαρξη λύσεων των εξισώσεων~\eqref{eq:pp_un_gare_general}
και~\eqref{eq:pp_un_gare_a}. Ακόμα οι λύσεις οι οποίες προκύπτουν δεν είναι
μοναδικές ή μπορεί ο αντίστοιχος πίνακας \tl{Riccati} να μην είναι θετικά
ορισμένος. Για το λόγο αυτό το παρόν κεφάλαιο συνοψίζεται σε έναν αλγόριθμο
τριών βημάτων, όπου επιλύουμε προβλήματα ελαχιστοποίησης \tl{LMI} ούτως ώστε το
εγγυημένο κόστος να είναι το ελάχιστο και ακόμα να ικανοποιείται ο βαθμός
σχετικής ευστάθειας.

\section{Αλγόριθμος εύρωστης τοποθέτησης πόλων}
Θα παρουσιάσουμε τα βήματα του αλγορίθμου εφαρμόζοντας ένα παράδειγμα και σε
κάθε βήμα θα παρουσιάσουμε και τον αντίστοιχο κώδικα \tl{MATLAB} που το
υλοποιεί.

Θα μελετήσουμε το σύστημα της μορφής
\[
    \dot{x}(t) = (A + \Delta A)x(t) + Bu(t), \quad x(0) = 0,
\]
όπου
\[
    A =
    \begin{pmatrix}
        0 & 1 & 0 \\
        0 & 0 & 1 \\
        1 & 2 & -1
    \end{pmatrix}, \quad
    B =
    \begin{pmatrix}
        0 \\
        0 \\
        1
    \end{pmatrix}.
\]
Ακόμη οι αβεβαιότητες περιγράφονται από τους πίνακες
\[
    A_1 =
    \begin{pmatrix}
        0 & 0 & 0 \\
        0 & 0 & 0 \\
        0 & 1 & 0
    \end{pmatrix}, \quad
    A_2 =
    \begin{pmatrix}
        0 & 0 & 0 \\
        0 & 0 & 0 \\
        0 & 0 & 1
    \end{pmatrix}.
\]
Για συνέπεια με τους συμβολισμούς μέχρι τώρα έχουμε ότι η διάσταση του
προβλήματος, δηλαδή η διάσταση του πίνακα \( A \) είναι \( n = 3 \) και το
πλήθος των αβεβαιοτήτων \( k = 2 \). Ένας πιθανός διαχωρισμός των αβεβαιοτήτων είναι
\[
    A_1 = d_1e_1^T =
    \begin{pmatrix}
        0 \\
        0 \\
        1
    \end{pmatrix}
    \begin{pmatrix}
        0 & 1 & 0
    \end{pmatrix}, \quad
    A_2 = d_2e_2^T =
    \begin{pmatrix}
        0 \\
        0 \\
        1
    \end{pmatrix}
    \begin{pmatrix}
        0 & 0 & 1
    \end{pmatrix}.
\]
Ακόμη ορίζουμε τους πίνακες
\[
    D = \begin{pmatrix} d_1 & \dots & d_k\end{pmatrix}, \quad
    E = \begin{pmatrix} e_1 & \dots & e_k\end{pmatrix}^T,
\]
ή αντικαθιστώντας
\[
    D =
    \begin{pmatrix}
        0 & 0 \\
        0 & 0 \\
        1 & 1
    \end{pmatrix}, \quad
    E =
    \begin{pmatrix}
        0 & 1 & 0 \\
        0 & 0 & 1
    \end{pmatrix}.
\]
Ακόμη επιλέγουμε τα μητρώα στάθμισης \( Q = I_3 \) και \( R = 1 \). Τέλος,
επιλέγουμε το βαθμό σχετικής ευστάθειας \( a = 1 \). Τα δεδομένα του
προβλήματος υλοποιούνται στη συνάρτηση \mono{pp\_data} στο \tl{MATLAB} που
παρατίθεται παρακάτω.
\eng{\lstinputlisting[language=Matlab]{src/pp_data.m}}

\subsection{Βήμα 1}
Το πρώτο βήμα του αλγορίθμου περιλαμβάνει την επίλυση ενός προβλήματος
ελαχιστοποίησης γραμμικών ανισοτήτων πινάκων
\begin{equation*}
    \begin{aligned}
        & \underset{
            (M, W, S)
        }{\mathtxt{minimize}}
        & & \tr M \\
        & \mathtxt{subject to}
        & &
        \begin{bmatrix}
            M & I \\
            I & P
        \end{bmatrix} > 0 \\
        &&&
        \begin{bmatrix}
            -W(A + aI)^T - (A + aI)W + BR^{-1}B^T
            - DSD^T & WE^T & W \\
            EW & S & 0 \\
            W & 0 & Q_0^{-1}\\
        \end{bmatrix} > 0,
    \end{aligned}
\end{equation*}
όπου έχει ένα μη κενό σύνολο εφικτών λύσεων \( (M, W, S) \) με \( M \) και \( W
\) συμμετρικοί και θετικά ορισμένοι και \( Q_0 < Q \). Ο πίνακας \( S \) επιλέγεται
διαγώνιος
\[
    S = \diag\begin{pmatrix} \sigma_1 & \dots & \sigma_k\end{pmatrix}
\]
και περιγράφει το διαχωρισμό των αβεβαιοτήτων μέσω της σχέσης
\begin{equation}\label{eq:pp_sep}
    d_ie_i^T = \sigma_i d_i (1/\sigma_i)e_i^T, \quad i = 1, \dots ,k.
\end{equation}
Αν υπάρχει εφικτή λύση του προβλήματος τότε ο \( S \) περιγράφει το βέλτιστο
διαχωρισμό υπό την έννοια ότι το ίχνος του πίνακα \( P \) της
σχέσης~\eqref{eq:pp_un_gare_general} είναι ελάχιστο. Ακόμη ισχύει ότι \( P =
W^{-1} \).

Στο παράδειγμα η επίλυση του προβλήματος \tl{LMI} δίνει
\[
    S =
    \begin{pmatrix}
        0.1488 & 0 \\
        0 & 0.1578
    \end{pmatrix}.
\]
Παρακάτω παρατίθεται το πρώτο βήμα του αλγορίθμου όπως υλοποιήθηκε στο
\tl{MATLAB}.
\eng{\lstinputlisting[language=Matlab]{src/pp_step1.m}}

\subsection{Βήμα 2}
Εφόσον υπάρχει λύση, και άρα ο βέλτιστος διαχωρισμός \( S \) είναι
γνωστός, υπολογίζονται οι πίνακες \( T \) και \( U \). Συγκεκριμένα, επιλέγουμε
το βέλτιστο διαχωρισμό, δηλαδή από τη σχέση~\eqref{eq:pp_sep} προκύπτει
\[
  T = \sum_{i = 1}^k \sigma_i^2 d_id_i^T, \quad
  U = \sum_{i = 1}^k (1/\sigma_i)^2 e_ie_i^T,
\]
ή για το παράδειγμα υπολογίζουμε
\[
    T =
    \begin{pmatrix}
        0 & 0 & 0 \\
        0 & 0 & 0 \\
        0 & 0 & 0.047
    \end{pmatrix}, \quad
    U =
    \begin{pmatrix}
        0 & 0 & 0 \\
        0 & 45.1914 & 0 \\
        0 & 0 & 40.138
    \end{pmatrix}.
\]

Δεδομένου του βαθμού σχετικής ευστάθειας \( a = 1 \) θέλουμε να υπολογίσουμε τη
μεταβολή του πίνακα στάθμισης των αβεβαιοτήτων, όπως περιγράφεται στο
προηγούμενο θεώρημα, από τη σχέση
\[
    \Delta Q = -2aP_u.
\]
Για να υπολογίσουμε τον όρο \( \Delta Q \) πρέπει πρώτα να βρούμε τον αρνητικά
ορισμένο πίνακα \( P_u \). Ο πίνακας αυτός συνδέεται με τον Χαμιλτονιανό
πίνακα~\eqref{eq:pp_hamil} και υπολογίζεται από
\[
    P_u = Z_0 W_0^{-1},
\]
όπως έχουμε αναφέρει προηγουμένως.

Συνεπώς υπολογίζουμε τη μορφή \tl{Jordan} του Χαμιλτονιανού
πίνακα~\eqref{eq:pp_hamil} και στη συνέχεια τους όρους \( P_u \), \( \Delta
Q \) και τροποποιούμε τον πίνακα κατάστασης κατά \( \Delta Q \).
Πραγματοποιώντας τις πράξεις βρίσκουμε
\[
    P_u =
    \begin{pmatrix}
        -14.5314 & 12.5177 & -0.4171 \\
        12.5177 & -67.0584 & 10.9952 \\
        -0.4171 & 10.9952 & -9.2558 \\
    \end{pmatrix}, \quad
    \Delta Q =
    \begin{pmatrix}
        29.0628 & -25.0355 & 0.8342 \\
        -25.0355 & 134.1167 & -21.9904 \\
        0.8342 & -21.9904 & 18.5116
    \end{pmatrix},
\]
με τον πρώτο να είναι αρνητικά ορισμένος και το δεύτερο θετικά.

Ο αντίστοιχος κώδικας \tl{MATLAB} που υλοποιεί το δεύτερο βήμα του αλγορίθμου
παρατίθεται παρακάτω.
\eng{\lstinputlisting[language=Matlab]{src/pp_step2.m}}

\subsection{Βήμα 3}
